#!/usr/bin/env ruby

branch = ARGV[0]
author = ARGV[1]

#authors = `git log 20721320818901a5d3dd8ea17c6fb07b3a192515.. --format="%aN <%aE>" | grep @xing.com | sort -u`.chomp.split

author_name =
  case author
  when /albert/i
    "Albert Llop <albert.llop@xing.com>"
  when /jean/i
    "Jean Carlos Meninno <jean-carlos.meninno@xing.com>"
  when /jorge/i
    "Jorge Dias <jorge.dias@xing.com>"
  when /julia/i
    "Julia Lopez <julia.lopez@xing.com>"
  end

squash_cmd = "git merge --squash #{branch}"

commit_cmd = "git commit"
commit_cmd << " --author=\"#{author_name}\"" if author_name

if system(squash_cmd)
  system(commit_cmd)
else
  puts "Error squashing"
end
